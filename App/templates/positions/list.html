{% extends "layout.html" %}
{% block title %}Positions{% endblock %}
{% block page %}Positions{% endblock %}

{{ super() }}

{% block content %}
<div class="row">
  <h4>Available Positions</h4>
</div>

<!-- Search & Filter Form -->
<div class="row">
  <form method="GET" action="{{ url_for('position_views.list_positions_page') }}" class="col s12">
    <div class="row">
      <div class="input-field col s6">
        <input id="search" name="search" type="text" value="{{ request.args.get('search', '') }}">
        <label for="search">Search by Title</label>
      </div>
      <div class="input-field col s4">
        <select name="status">
          <option value="" {% if not request.args.get('status') %}selected{% endif %}>All</option>
          <option value="open" {% if request.args.get('status') == 'open' %}selected{% endif %}>Open</option>
          <option value="closed" {% if request.args.get('status') == 'closed' %}selected{% endif %}>Closed</option>
        </select>
        <label>Status Filter</label>
      </div>
      <div class="input-field col s2">
        <button type="submit" class="btn waves-effect waves-light purple">Filter</button>
      </div>
    </div>
  </form>
</div>

<!-- Position Cards -->
<div class="row">
  {% for pos in positions %}
    <div class="col s12 m6 l4">
      <div class="card">
        <div class="card-content">
          <span class="card-title">{{ pos.title }}</span>
          <p>Status: {{ pos.status.value }}</p>
          <p>Openings: {{ pos.number_of_positions }}</p>
          <p>Employer ID: {{ pos.employer_id }}</p>
        </div>
        <div class="card-action">
          <a href="{{ url_for('position_views.position_detail_page', id=pos.id) }}" class="purple-text">
            View Details
          </a>
        </div>
      </div>
    </div>
  {% else %}
    <p>No positions found.</p>
  {% endfor %}
</div>
{% endblock %}