{% extends 'layout.html' %}

{% block title %}Add to Shortlist{% endblock %}
{% block page %}Add to Shortlist{% endblock %}

{% block content %}
  <div style="margin-top:20px; max-width:800px">
    <a href="/dashboard" class="btn btn-secondary" style="margin-bottom:12px;">‚Üê Back to Dashboard</a>
    <form method="POST" action="/shortlist/add" style="background:#fff;padding:20px;border-radius:8px;box-shadow:0 1px 6px rgba(0,0,0,.08)">
      <input type="hidden" name="position_id" value="{{ position_id or 1 }}">
      <label for="student_user_id">Select Student</label>
      <select id="student_user_id" name="student_user_id" required style="width:100%;padding:8px;margin-bottom:12px;border:1px solid #ddd;border-radius:4px">
        <option value="">Select a student...</option>
        {% for stud in students %}
          <option value="{{ stud.id }}" data-name="{{ stud.username }}" data-studentid="{{ stud.id }}">{{ stud.username }} (ID: {{ stud.id }})</option>
        {% endfor %}
      </select>
      <input type="hidden" id="student_name" name="student_name">
      <input type="hidden" id="student_id" name="student_id">
      <label for="details">Details</label>
      <textarea id="details" name="details" placeholder="Enter application details" required style="width:100%;padding:8px;border:1px solid #ddd;border-radius:4px"></textarea>
      <div style="margin-top:12px"><button type="submit" class="btn btn-primary">Add to Shortlist</button></div>
    </form>
    <script>
      const studentSelect = document.getElementById('student_user_id');
      if (studentSelect) {
        studentSelect.addEventListener('change', function(){
          const opt = this.options[this.selectedIndex];
          document.getElementById('student_name').value = opt?.dataset?.name || '';
          document.getElementById('student_id').value = opt?.dataset?.studentid || '';
        });
      }
    </script>
  </div>
{% endblock %}